name: 'Python + Hatch'

description: 'Configures Python and installs Hatch.'

inputs:
  needs-clone:
    description: 'Clone repository or is it already cloned?'
    default: true
  python-version:
    description: 'Version of the Python interpreter.'

runs:
  using: composite
  steps:

    - name: Construct Foundation
      if: "${{ 'true' == inputs.needs-clone }}"
      uses: actions/checkout@v4
      with:
        lfs: true

    - name: Select Python Version
      uses: actions/setup-python@v5
      with:
        python-version: '${{ inputs.python-version }}'

    - name: Upgrade pip
      run: python -m pip install --upgrade pip
      shell: bash

    - name: Install hatch
      run: |
        set -eu -o pipefail
        if [[ -f '.auxiliary/configuration/hatch-constraints.pip' ]]; then
          constraints='--constraint .auxiliary/configuration/hatch-constraints.pip'
        else constraints=''; fi
        python -m pip install ${constraints} hatch
      shell: bash
