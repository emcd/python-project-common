#!/bin/bash

# claude-ds: Rhymes with "Claudius", the bowtie-wearing tungsten cube vendor.

eecho() {
    echo "$@" >&2
}

ENV_FILE=".auxiliary/secrets/deepseek-api.env"

if [[ ! -f "${ENV_FILE}" ]]; then
    eecho "Error: Environment file not found at '${ENV_FILE}'."
    eecho "Please create the file with your DeepSeek API key."
    exit 1
fi

source "${ENV_FILE}"

if [[ -z "${DEEPSEEK_API_KEY}" ]]; then
    eecho "Error: DEEPSEEK_API_KEY not found in '${ENV_FILE}'."
    eecho "Please set DEEPSEEK_API_KEY=your_api_key in the environment file."
    exit 1
fi

export ANTHROPIC_BASE_URL="https://api.deepseek.com/anthropic"
export ANTHROPIC_AUTH_TOKEN="${DEEPSEEK_API_KEY}"
export ANTHROPIC_MODEL="deepseek-chat"
export ANTHROPIC_SMALL_FAST_MODEL="deepseek-chat"

eecho "Anthropic API URL: ${ANTHROPIC_BASE_URL}"
eecho "Claude Model: ${ANTHROPIC_MODEL}"

exec claude "$@"
